plot.SPSC(SPSC.Smoking)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
matrix(Basis[t,],1,4)
matrix(Basis[1,],1,4)
matrix(Basis[2,],1,4)
matrix(Basis[2,],1,4)
matrix(Basis[T0,],1,4)
matrix(Basis[T1,],1,4)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(Basis[t,],1,4)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis0 <- splines::bs(1:T0,df=4,intercept=F)
Basis1 <- splines::bs(1:T1,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis1[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(Basis0[t,],1,4)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(Basis[t,],1,4)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(Basis[t,],1,4)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
ginv(S1)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t,t^2),1,3)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-2,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1.5,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
dev.off()
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1.5,4,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1.5,4,by=0.1),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
Basis <- splines::bs(1:Tt,df=4,intercept=F)
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){matrix(Basis[t,],1,4)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1.5,1,by=0.1),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
SPSC.Smoking$lambda
?SPSC
# install.packages(tidysynth)
library(tidysynth)
data("smoking")
State <- unique(smoking$state)
N <- length(unique(smoking$state))-1
Y <- smoking$cigsale[smoking$state=="California"]
Tt <- length(Y)
T0 <- 18
T1 <- Tt-T0
D <- matrix(0,Tt,N+1)
for(jj in 1:(N+1)){
D[,jj] <- smoking$cigsale[smoking$state==State[jj]]
}
D <- D[,-which(State=="California")]
Y.Pre <- Y[1:T0]
Y.Post <- Y[T0+1:T1]
D.Pre <- D[1:T0,]
D.Post <- D[T0+1:T1,]
## SPSC
## smaller regularization parameters return numeric error due to small sample size
SPSC.Smoking <- SPSC(Y.Pre              = Y.Pre,
Y.Post             = Y.Post,
W.Pre              = D.Pre,
W.Post             = D.Post,
detrend            = TRUE,
detrend.ft         = function(t){Spline.Trend(t,T0,df=5)},
Y.basis            = function(y){matrix(c(y),1,1)},
att.ft             = function(t){matrix(c(1,t),1,2)},
lambda.type        = "cv",
lambda.value       = NULL,
lambda.grid        = seq(-1,2,by=0.5),
bootstrap.num      = 100,
conformal.period   = NULL,
conformal.cover    = FALSE,
true.effect        = NULL,
conformal.interval = FALSE,
conformal.pvalue   = 0.05,
conformal.window   = 25)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$ASE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$ASE.ATT)
cbind(SPSC.Smoking$ATT - 1.96*SPSC.Smoking$BSE.ATT,
SPSC.Smoking$ATT + 1.96*SPSC.Smoking$BSE.ATT)
## Graphical summary
plot.SPSC(SPSC.Smoking)
?SPSC
?SPSC
